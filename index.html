<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    #games {
      position: relative;
      display: grid;
      grid-template-columns: auto auto;
      grid-template-rows: auto auto;
      /* justify-content: center;*/
    }

    .game {
      border: 1px solid white;
      box-sizing: border-box;
      overflow: hidden;
      font-size: 10px;
      line-height: 12px;
      text-align: center;
      color: white;
    }
  </style>
  <body>
    <h1 id="title">0</h1>
    <div id="games"></div>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script>
    (async () => {
      const width = $(window).width();
      const height = $(window).height();

      const games = $("#games");

      const data = await fetch("./most_played.json");
      const nodes = await data.json();

      let x = 0;
      let y = 0;

      const totalValue = nodes.reduce((sum, game) => sum + game.value, 0);

      nodes.sort((a, b) => b.value - a.value);

      $("#title")
        .css({ position: "absolute", top: 0, left: 0, zIndex: 1 })
        .text(totalValue);

      nodes.forEach(({ name, value }, index) => {
        const nodeWidth = (value / totalValue) * width;
        const nodeHeight = (value / totalValue) * height;

        const div = $("<div>")
          .addClass("game")
          .css({
            width: `${nodeWidth}px`,
            height: `${nodeHeight}px`,

            backgroundColor: gerarCorAleatoria(),
          })
          .text(name);

        games.append(div);

        x += nodeWidth;
      });
    })();

    function gerarCorAleatoria() {
      const hex = "0123456789ABCDEF";
      let cor = "#";

      for (let i = 0; i < 6; i++) {
        cor += hex[Math.floor(Math.random() * 16)];
      }

      return cor;
    }
  </script>
</html>
